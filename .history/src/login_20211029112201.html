<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login</title>
    <link href="/assets/lib/bootstrap-5.0.2-dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="/assets/lib/bootstrap-5.0.2-dist/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" href="/assets/css/signin.css">
    <link href="/assets/lib/fontawesome-free-5.15.4-web/fontawesome-free-5.15.4-web/css/all.css">
   <script src="/assets/lib/fontawesome-free-5.15.4-web/fontawesome-free-5.15.4-web/js/all.js"></script>

    <!-- <script type="text/javascript" src="/assets/script/signin.js"></script> -->

    <script>
        // Below function Executes on click of login button.
        function validate() {
            var email = document.getElementById("email").value;
            var password = document.getElementById("password").value;
            console.log(email);
            console.log(password);
            var user = JSON.parse(localStorage.getItem("users"));
            // console.log(user.password);
            for (var i = 0; i < user.length; i++) {
                if (user[i].password == password && user[i].email == email){
                    alert("Login Successful");
                    
                    var uid = user[i].id;
                    const obj = {
                        "userid" : uid,
                        "log": [
                            "id : user[i].id",
                            "browserVersion : navigator.appVersion",
                            "browserAgent : navigator.userAgent",
                            "browserName : navigator.appName",
                            "fullVersion : '' + parseFloat(navigator.appVersion)",
                            "majorVersion : parseInt(navigator.appVersion, 10)",
                            "browserPlatform : navigator.platform",
                            "browserEngine: navigator.product",
                            "locationHostname : window.location.hostname",
                            "locationProtocol : window.location.protocol"
                        ],
                    };


                    const myJSON = JSON.stringify(obj);
                    console.log(myJSON);
                    alert(myJSON);

                    localStorage.setItem('myJavaScriptObject',myJSON);

                    var xhttp = new XMLHttpRequest();
                    xhttp.open("POST", "logs.json", true);

                    xhttp.setRequestHeader("Content-Type", "application/json");

                    alert("request")
                    xhttp.onreadystatechange = function () {
                        if (this.readyState == 4 && this.status == 200) {
                            alert("readystate")
                            // Response
                            var response = this.responseText;
                            alert(response);
                        }
                    };
                    // var data = { name: 'yogesh', salary: 35000, email: 'yogesh@makitweb.com' };
                    xhttp.send(JSON.stringify(obj));

                    // localStorage.setItem('User', JSON.stringify(obj));
                    // localStorage.setItem("name", username);
                    // localStorage.setItem("LoginTime", Date());
                    // document.getElementById("demo").innerHTML = localStorage.getItem("name") + localStorage.getItem("LoginTime");
                     window.location.href = "Listing.html";
                    return false;
                }
                   
                }
            alert("User does not exist");
              

            }

        
                // id = user.id;
                // if (password == user.password && email == user.email) {
                    // alert("Login successfully");
                    // const obj = {
                    //     "userdata": [
                    //         "id:user.id",
                    //         "browserVersion : navigator.appVersion",
                    //         "browserAgent : navigator.userAgent",
                    //         "browserName : navigator.appName",
                    //         "fullVersion : '' + parseFloat(navigator.appVersion)",
                    //         "majorVersion : parseInt(navigator.appVersion, 10)",
                    //         "browserPlatform : navigator.platform",
                    //         "browserEngine: navigator.product",
                    //         "locationHostname : window.location.hostname",
                    //         "locationProtocol : window.location.protocol"
                    //     ],
                    // };
                    // const myJSON = JSON.stringify(obj);
                    // console.log(myJSON);
                    // alert(myJSON);

                    // localStorage.setItem('User', JSON.stringify(obj));
                    // localStorage.setItem("name", username);
                    // localStorage.setItem("LoginTime", Date());
                    // document.getElementById("demo").innerHTML = localStorage.getItem("name") + localStorage.getItem("LoginTime");
                    // window.location = "success.html"; // Redirecting to other page.
                    // return false;
                // }
                // else {
                //     alert("error")
                // }
            //}
    </script>
</head>

<body>
    <div class="container">
        <div class="row">
            <div class="col-sm-6" style="align-items: center; justify-content: center;">
                <img src="/assets/images/signup.jpg" style="width: 100%; height: auto;">
            </div>
            <div class="col-sm-6">
                <form name="myForm" onsubmit="return validate()" method="post">
                    <div class="container">
                        <h2 style="padding:10px; color: dodgerblue;">Login</h2>
                        <div class="input-container">
                            <i class="fa fa-envelope icon"></i>
                            <input type="text" placeholder="Enter Email " name="email" id="email" required>

                        </div>

                        <!-- <label for="psw"><b>Password</b></label> -->
                        <div class="input-container">
                            <i class="fa fa-key icon"></i>
                            <input type="password" placeholder="Enter Password" name="psw" id="password" required>

                        </div>
                        <button type="submit">Sign in</button>
                        <label>
                            <a href="SignUp.html">Sign up here</a>

                        </label>

                        <label>
                            <a href="forgetPassword.html">Forget Password?</a>

                        </label>
                    </div>
                </form>
            </div>


        </div>
    </div>
</body>

<!-- <script>
    var sign = new signin();
    email=document.getElementById("email").value;
    alert(email);
    password= document.getElementById("password").value;
    // sign.validate(email,password)
    document.getElementById("signin").addEventListener("click", sign.validate(email,password) );
</script> -->

</html>